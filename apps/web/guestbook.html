<!DOCTYPE html>
<!--This file created 4/26/21 8:35 PM by Claris Home Page version 2.0-->
<HTML LANG="en">
<HEAD>
   <TITLE>zxyz's guestbook</TITLE>
   <META NAME=GENERATOR CONTENT="Claris Home Page 2.0" />
   <META NAME="viewport" CONTENT="width=device-width,initial-scale=1" />
   <META NAME="twitter:title" CONTENT="zxyz's guestbook" />
   <META NAME="og:title" CONTENT="zxyz's guestbook" />
   <META CONTENT="object" PROPERTY="og:type" />
   <META CONTENT="x-t.github.io" PROPERTY="og:site_name" />
   <META NAME="description" CONTENT="guestbook on my site" />
   <META NAME="twitter:description" CONTENT="guestbook on my site" />
   <META NAME="og:description" CONTENT="guestbook on my site" />
   <META CONTENT="128" PROPERTY="og:image:width" />
   <META CONTENT="128" PROPERTY="og:image:height" />
   <META NAME="og:image" CONTENT="/img/favicon@128.jpg" />
   <META NAME="twitter:image" CONTENT="/img/favicon@128.jpg" />
   <META CONTENT="summary" PROPERTY="twitter:card" />
   <LINK REL="shortcut icon" HREF="favicon.ico" TYPE="image/x-icon" />
   <LINK REL="shortcut icon" HREF="/img/favicon@64.jpg" TYPE="image/jpeg" />
   <LINK REL="shortcut icon" HREF="/img/favicon@64.webp" TYPE="image/webp" />
   <LINK REL="manifest" HREF="/manifest.json" />
   <link rel="preload" href="/font/AppleGaramond.woff2" as="font" type="font/woff2" crossorigin />
   <link rel="preload" href="/font/AppleGaramond-Bold.woff2" as="font" type="font/woff2" crossorigin />
   <link rel="preload" href="/font/AppleGaramond-Italic.woff2" as="font" type="font/woff2" crossorigin />
   <link rel="preload" href=import.meta.env.VITE_FETCH_ENDPOINT as="fetch" crossorigin="anonymous" />
   <link rel="preload" href="/img/darkbg.jpeg" as="image" media="(prefers-color-scheme: dark)" />
   <STYLE>
      #guestbookPosts {
         padding-top: 40px;
      }

      #postDialog > form > table > tbody > tr > td:first-of-type > p {
         text-align: left;
      }
   </STYLE>
   <X-SAS-WINDOW TOP=53 BOTTOM=600 LEFT=152 RIGHT=682 />
</HEAD>
<BODY BGCOLOR="#FFFFCA" BACKGROUND="/img/chillibk.gif">
<P id="W"><TABLE WIDTH="80%">
   <TR>
      <TD HEIGHT=438>
         <H1>
            <A HREF="/" ARIA-LABEL="Go back"><PICTURE><SOURCE SRCSET="/img/guestbook.webp" TYPE="image/webp" /><IMG SRC="/img/guestbook.png" WIDTH=30 HEIGHT=33 ALT=""
               X-SAS-UseImageWidth X-SAS-UseImageHeight ALIGN=bottom /></PICTURE></A>
         </H1>

         <H1>guestbook</H1>

         <noscript>
            <hr />
            For full functionality of this site it is necessary to enable JavaScript.
            Here are the <a href="https://www.enable-javascript.com/">
            instructions how to enable JavaScript in your web browser</a>.
            <hr />
           </noscript>

         <P>you're welcome to leave a mark. <A HREF="https://github.com/x-t/x-t.github.io">source code here</A>.</P>

         <P><DIV ID="postDialog">
            <form
            x-data="{submitting: false,
               endpoint: window.endpoints.form,
               error: ''}"
            x-id="['name-field', 'comment-field', 'form']"
            @submit.prevent="submitting = true;
               window.botdPromise
               .then(botd => botd.detect())
               .then(result => {
                  return new Promise((resolve, reject) => {
                     if (!result.bot)
                        resolve();
                  });
               })
               .then(() => {
                  document.getElementById($id('form')).submit();
               })
               .catch((e) => {
                  submitting = false;
                  error = 'An error occured.';
                  console.log(e);
               });"
            method="post"
            :action="endpoint"
            :id="$id('form')"
            >
            <TABLE BORDER=0>
               <caption style="display: none;">Guestbook posting form</caption>
            <TR>
               <TD>
                  <P><label :for="$id('name-field')">name</label></P>
               </TD><TD>
                  <P><INPUT :id="$id('name-field')"
                  TYPE="text" NAME="name" VALUE="" SIZE=25
                  MAXLENGTH=32 id="guestbookName" placeholder="Anonymous" /></P>
               </TD></TR>
            <TR>
               <TD>
                  <P><label :for="$id('comment-field')">comment</label></P>
               </TD><TD>
                  <P><INPUT :id="$id('comment-field')"
                  TYPE="text" NAME="comment" VALUE="" SIZE=25
                  MAXLENGTH=128 id="guestbookComment" required /></P>
               </TD></TR>
               <TR><TD></TD><TD style="text-align: right;">
                  <input type="submit"
                     style="width:100px;" value="post" /></TD></TR>
         </TABLE>
         <template x-if="error">
            <p class="error_cl"
            x-text="error"></p>
         </template>
      </form>
      </DIV></P>
         <DIV ID="guestbookPosts">
            <TABLE BORDER=1
               x-data="{posts: [],
                  loading: true,
                  endpoint: window.endpoints.fetch,
                  error: ''}"
               x-init="fetch(endpoint)
                  .then(response => response.json())
                  .then(data => {posts = data.posts; loading = false;})
                  .catch((e) => {
                     loading = false;
                     error = 'An error occured.';
                     console.log(e);
                  });"
               >
               <caption style="display: none;">Guestbook posts</caption>
               <TR>
                  <TH>date</TH>
                  <TH>name</TH>
                  <TH>comment</TH>
               </TR>
               <template x-if="loading || error">
                  <TR><TD COLSPAN=3
                     x-text="loading ? 'Loading...' : error"
                     :class="error ? 'error_cl' : ''">loading...</TD></TR>
               </template>
               <template x-for="post in posts">
                  <tr>
                     <td x-data="{date: new Date(post.created_at)}"
                        x-text="
                        date.toLocaleDateString()
                        + ' ' + date
                        .toLocaleTimeString([],
                           {hour: '2-digit',minute: '2-digit'})"></td>
                     <td x-text="post.name || 'Anonymous'"></td>
                     <td x-text="post.comment"></td>
                  </tr>
               </template>
            </TABLE>
         </DIV>
      </TD></TR>
</TABLE></P>
<P>(c) zxyz. <SPAN ID="FSP" TITLE="Icons & cursor licensed under the MIT license, by Haiku.">copy it</SPAN>. i won't be mad.</P>
<script type="module" src="/src/main.ts" defer></script>
<script type="module" src="/src/guestbook.ts"></script>
</BODY>
</HTML>
